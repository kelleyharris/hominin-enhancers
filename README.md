# hominin-enhancers
A code repository for "Selection against archaic DNA in human regulatory regions" by Telis, Aguilar, &amp; Harris 2019

This repository contains everything you'll need to generate the plots in the main text of Telis, et al. 2019. If you need additional info, please contact harriske@uw.edu.

All figures in the paper that summarize archaic variation (1B, 2, 3A, 3B, 4A, 4B, 5C, 5D) require you to first compile counts of Neanderthal and Denisovan variation in enhancers. Figures 1B, 2, 4A, and 4B utilize counts from specific to the Simons Genome Diversity Project (SGDP) populations, which are Westeurasia, Southasia, Eastasia, Centralasia, America, and Oceania. The summary counts you need for Figures 1, 2, and 3 are available in the repository in the following files:
  SPECIES_POPUL2_snps.txt (1)
  SPECIES_POPUL2_controls.txt (2)
where SPECIES equals neandertal or denisova and popul is one of the SGDP population names (all lowercase). Throughout the README, line numbers are provided for reference but are not intended to be typed into the commands. For Figure 4, you also need:
  POPUL_SPECIES_1minusboth2_snps.txt (3)
  POPUL_SPECIES_1minus2_controls.txt (4)

If you want to generate these count summaries from scratch, you will need to download the archaic call repository available at https://sriramlab.cass.idre.ucla.edu/public/sankararaman.curbio.2016/summaries.tgz. The following command generates files (1) and (2):

  python get_archaic_and_controls.py 2 SPECIES POPUL
  
The script "get_archaic_and_controls.py" calls a series of other scripts, and they all access the input archaic calls via the path infile=open('../../../Desktop/summaries/'+oneortwo+'/'+species+'/'+popul+'/summaries/pred.'+str(chrom)+'.thresh-50.length-0.00'). You'll need to replace this with the path to these calls wherever they are located on your system.

The following command will generate the count summaries (3) and (4), the first script looping through all SGDP populations automatically:

  python get_old_nonshared_archaic2.py SPECIES (5)
  python get_noncombined_1minus2_controls.py POPUL SPECIES (6)
  
To generated Figure 5, you'll need to generate the following combined sets of variation compiled across all populations:
  SPECIES_allpops_2_snps_plus_bstat.txt
  allpops_SPECIES_2_controls.txt
  
To generate these files from the raw calls, the first step is to generate the population-specific counts that we already discussed. The second step is to run the commands
  python compile_archaic_across_populs.py SPECIES 2
  python get_controls_compiled_across_populs.py 2 SPECIES

Figure 4A is generated by "python count_1and2_snpcalls.py".

